<div class="payment-product">
  <div class="payment">
    @for(card of (toPaymentCards$ | async); track card.id) {

    <mat-card class="payment-card__container">
      <mat-card-header><mat-card-title class="payment-card__title">{{ card.title }}</mat-card-title></mat-card-header>

      <mat-card-content>
        <mat-card-header><mat-card-title class="payment-card__cost">Цена: {{ card.cost | currency : 'RUB' :
            'symbol-narrow' }}</mat-card-title></mat-card-header>
        <div class="payment-card__total-wrapper">
          <mat-chip-set>
            <mat-chip>
              Количество: {{ card.count }}
            </mat-chip>
            <mat-chip>
              Стоимость: {{ card.cost * card.count | currency : 'RUB' : 'symbol-narrow' }}
            </mat-chip>
          </mat-chip-set>

        </div>
      </mat-card-content>

    </mat-card>
    }
  </div>
  <mat-chip-set><mat-chip class="payment__total-amount">Итого к оплате: {{ getTotalPrice() }}</mat-chip></mat-chip-set>

</div>

<mat-stepper [linear]="true" #stepper>
  <mat-step label="Персональные данные" [stepControl]="personalDataForm">
    <form [formGroup]="personalDataForm">
      <personal-data></personal-data>
    </form>
    <button matButton="tonal" matStepperNext [disabled]="!personalDataForm.valid">Далее</button>
  </mat-step>

  <mat-step label="Данные для оплаты" [stepControl]="paymentDetailsForm" [editable]="personalDataForm.valid">
    <form [formGroup]="paymentDetailsForm">
      <payment-details></payment-details>
    </form>
    <div>
      <button matButton="tonal" matStepperPrevious>Назад</button>
      <button matButton="tonal" [disabled]="!paymentDetailsForm.valid" (click)="onSubmit()">
        Подтвердить
      </button>
    </div>
  </mat-step>
</mat-stepper>